{
    "name": "vasp gamma kpoint convergence plus relaxation plus zero point energy plus formation energy for bulk material",
    "app": "vasp",
    "units": [
        {
            "head": true,
            "type": "assignment",
            "flowchartId": "initialize_TOLERANCE",
            "next": "initialize_previous_energy",
            "assignment": {
                "scope": "global",
                "name": "TOLERANCE",
                "value": "1e-3"
            }
        },
        {
            "type": "assignment",
            "flowchartId": "initialize_SCALAR_RESULT",
            "next": "initialize_PARAMETER",
            "assignment": {
                "scope": "global",
                "name": "SCALAR_RESULT",
                "value": "0"
            }
        },
        {
            "type": "assignment",
            "flowchartId": "initialize_PARAMETER",
            "next": "run_scf_calculation",
            "assignment": {
                "name": "PARAMETER",
                "value": "1"
            }
        },
        {
            "flowchartId": "run_scf_calculation",
            "type": "execution",
            "next": "check_for_convergence",
            "head": true,
            "monitors": [
                {
                    "name": "standard_output"
                },
                {
                    "name": "delta_energy"
                },
                {
                    "name": "total_energy"
                }
            ],
            "preProcessors": [
                {
                    "type": "command",
                    "name": "copy_file",
                    "kwargs": {
                        "source": "KPOINTS",
                        "destination": "KPOINTS.convergence.save"
                    }
                }
            ],
            "execution": {
                "app": {
                    "name": "vasp",
                    "exec": "vasp"
                },
                "input": [
                    {
                        "name": "INCAR",
                        "content": "include_text(INCAR)"
                    },
                    {
                        "name": "KPOINTS",
                        "content": "include_text(KPOINTS)"
                    },
                    {
                        "name": "POSCAR",
                        "content": "include_text(POSCAR_CuO2)"
                    },
                    {
                        "name": "POTCAR",
                        "path": "POTCAR_CuO2"
                    }
                ]
            },
            "results": [
                {
                    "name": "total_energy"
                },
                {
                    "name": "band_gap"
                },
                {
                    "name": "bandstructure"
                }
            ]
        },
        {
            "flowchartId": "check_for_convergence",
            "type": "condition",
            "condition": {
                "input": [
                    {
                        "scope": "global",
                        "name": "previous_SCALAR_RESULT"
                    },
                    {
                        "scope": "run_scf_calculation",
                        "name": "total_energy"
                    }
                ],
                "statement": "abs(previous_SCALAR_RESULT-total_energy) < TOLERANCE",
                "then": "convergence_is_reached",
                "else": "assign_SCALAR_RESULT_to_previous_SCALAR_RESULT",
                "maxOccurences": 100
            }
        },
        {
            "flowchartId": "assign_SCALAR_RESULT_to_previous_SCALAR_RESULT",
            "type": "assignment",
            "next": "increase_PARAMETER_by_1",
            "assignment": {
                "input": [
                    {
                        "scope": "run_scf_calculation",
                        "name": "total_energy"
                    }
                ],
                "name": "previous_SCALAR_RESULT",
                "value": "total_energy"
            }
        },
        {
            "flowchartId": "increase_PARAMETER_by_1",
            "type": "assignment",
            "next": "increase_PARAMETER_by_1",
            "assignment": {
                "input": [
                    {
                        "scope": "global",
                        "name": "PARAMETER"
                    }
                ],
                "name": "PARAMETER",
                "value": "PARAMETER+1"
            }
        },
        {
            "flowchartId": "convergence_is_reached",
            "type": "assignment",
            "next": "run_relaxation",
            "assignment": {
                "input": [
                    {
                        "scope": "global",
                        "name": "PARAMETER"
                    }
                ],
                "name": "PARAMETER",
                "value": "PARAMETER-1"
            }
        },
        {
            "status": "idle",
            "flowchartId": "run_relaxation",
            "type": "compute",
            "next": "save_system_SCALAR_RESULT",
            "monitors": [
                {
                    "name": "standard_output"
                },
                {
                    "name": "delta_energy"
                },
                {
                    "name": "total_energy"
                }
            ],
            "postProcessors": [
                {
                    "type": "command",
                    "name": "copy_file",
                    "kwargs": {
                        "source": "CONTCAR",
                        "destination": "POSCAR"
                    }
                }
            ],
            "execution": {
                "app": {
                    "name": "vasp",
                    "exec": "vasp"
                },
                "input": [
                    {
                        "name": "INCAR",
                        "content": "include_text(INCAR_rlx)"
                    }
                ],
                "results": [
                    {
                        "name": "total_energy"
                    },
                    {
                        "name": "band_gap"
                    },
                    {
                        "name": "bandstructure"
                    }
                ]
            }
        },
        {
            "type": "assignment",
            "flowchartId": "save_system_SCALAR_RESULT",
            "next": "assign_number_of_atoms_of_element1",
            "assignment": {
                "scope": "global",
                "name": "compound_SCALAR_RESULT",
                "value": "total_energy"
            }
        },
        {
            "type": "assignment",
            "flowchartId": "assign_number_of_atoms_of_element1",
            "next": "ssign_number_of_atoms_of_element2",
            "assignment": {
                "scope": "global",
                "name": "element1_atoms",
                "value": 3
            }
        },
        {
            "type": "assignment",
            "flowchartId": "assign_number_of_atoms_of_element2",
            "next": "calculate_or_pull_from_database_zero_point_energy_of_element_1",
            "assignment": {
                "scope": "global",
                "name": "element2_atoms",
                "value": 6
            }
        },
        {
            "type": "assignment",
            "flowchartId": "calculate_or_pull_from_database_zero_point_energy_of_element_1",
            "next": "reset_N_K",
            "assignment": {
                "scope": "global",
                "name": "previous_SCALAR_RESULT",
                "value": "0"
            }
        },
        {
            "type": "assignment",
            "flowchartId": "initialize_PARAMETER_element1",
            "next": "initialize_previous_SCALAR_RESULT_element1",
            "assignment": {
                "name": "PARAMETER",
                "value": "1"
            }
        },
        {
            "type": "assignment",
            "flowchartId": "reset_previous_SCALAR_RESULT_element1",
            "next": "run_scf_calculation_of_element1",
            "assignment": {
                "name": "previous_SCALAR_RESULT_element1",
                "value": 0
            }
        },
        {
            "flowchartId": "run_scf_calculation_of_element1",
            "type": "execution",
            "next": "check_for_convergence_of_element1",
            "preProcessors": [
                {
                    "type": "command",
                    "name": "copy_file",
                    "kwargs": {
                        "source": "KPOINTS",
                        "destination": "KPOINTS.convergence.save.element1"
                    }
                }
            ],
            "monitors": [
                {
                    "name": "standard_output"
                },
                {
                    "name": "delta_energy"
                },
                {
                    "name": "total_energy"
                }
            ],
            "postProcessors": [],
            "execution": {
                "app": {
                    "name": "vasp",
                    "exec": "vasp"
                },
                "input": [
                    {
                        "name": "KPOINTS",
                        "content": "include_text(KPOINTS)"
                    },
                    {
                        "name": "INCAR",
                        "content": "include_text(INCAR)"
                    },
                    {
                        "name": "POSCAR",
                        "content": "include_text(POSCAR_Cu)"
                    },
                    {
                        "name": "POTCAR",
                        "path": "POTCAR_Cu"
                    }
                ]
            },
            "results": [
                {
                    "name": "total_energy"
                },
                {
                    "name": "band_gap"
                },
                {
                    "name": "bandstructure"
                }
            ]
        },
        {
            "flowchartId": "check_for_convergence_of_element1",
            "type": "condition",
            "condition": {
                "input": [
                    {
                        "scope": "global",
                        "name": "previous_SCALAR_RESULT_element1"
                    },
                    {
                        "scope": "run_scf_calculation_of_element1",
                        "name": "total_energy"
                    }
                ],
                "statement": "abs(previous_SCALAR_RESULT_element1-total_energy) < TOLERANCE",
                "then": "convergence_is_reached_of_element1",
                "else": "assign_total_energy_to_previous_SCALAR_RESULT_of_element1",
                "maxOccurences": 100
            }
        },
        {
            "flowchartId": "assign_total_energy_to_previous_SCALAR_RESULT_of_element1",
            "type": "assignment",
            "next": "increase_PARAMETER_by_1_of_element1",
            "assignment": {
                "input": [
                    {
                        "scope": "run_scf_calculation_of_element1",
                        "name": "total_energy"
                    }
                ],
                "name": "previous_SCALAR_RESULT",
                "value": "total_energy"
            }
        },
        {
            "flowchartId": "increase_PARAMETER_by_1_of_element1",
            "type": "assignment",
            "next": "run_scf_calculation_of_element1",
            "assignment": {
                "input": [
                    {
                        "scope": "global",
                        "name": "PARAMETER_element1"
                    }
                ],
                "name": "PARAMETER",
                "value": "PARAMETER+1"
            }
        },
        {
            "flowchartId": "convergence_is_reached_of_element1",
            "type": "assignment",
            "next": "run_relaxation_of_element1",
            "assignment": {
                "input": [
                    {
                        "scope": "global",
                        "name": "PARAMETER"
                    }
                ],
                "name": "PARAMETER",
                "value": "PARAMETER-1"
            }
        },
        {
            "status": "idle",
            "flowchartId": "run_relaxation_of_element1",
            "type": "execution",
            "next": "set_total_energy_of_element1",
            "monitors": [
                {
                    "name": "standard_output"
                },
                {
                    "name": "delta_energy"
                },
                {
                    "name": "total_energy"
                }
            ],
            "postProcessors": [
                {
                    "type": "command",
                    "name": "copy_file",
                    "kwargs": {
                        "source": "CONTCAR",
                        "destination": "POSCAR"
                    }
                }
            ],
            "execution": {
                "app": {
                    "name": "vasp",
                    "exec": "vasp"
                },
                "input": [
                    {
                        "name": "INCAR",
                        "content": "include_text(INCAR_rlx)"
                    }
                ]
            },
            "results": [
                {
                    "name": "total_energy"
                },
                {
                    "name": "band_gap"
                },
                {
                    "name": "bandstructure"
                }
            ]
        },
        {
            "flowchartId": "set_tSCALAR_RESULT_of_element1",
            "type": "assignment",
            "next": "run_zero_point_energy_of_element1",
            "assignment": {
                "scope": "global",
                "name": "SCALAR_RESULT_element1",
                "value": "total_energy"
            }
        },
        {
            "status": "idle",
            "flowchartId": "run_zero_point_energy_of_element1",
            "name": "run_zero_point_energy_of_element1",
            "type": "execution",
            "next": "done_with_convergence_plus_zero_point_energy_of_element1",
            "execution": {
                "app": {
                    "flavor": "vasp",
                    "exec": "vasp",
                    "name": "vasp"
                },
                "input": [
                    {
                        "name": "INCAR",
                        "content": "include_text(INCAR_zpe)"
                    }
                ]
            },
            "results": [
                {
                    "name": "total_energy"
                },
                {
                    "name": "zero_point_energy"
                }
            ],
            "monitors": [
                {
                    "name": "standard_output"
                },
                {
                    "name": "delta_energy"
                },
                {
                    "name": "total_energy"
                }
            ]
        },
        {
            "flowchartId": "set_zero_point_energy_of_element1",
            "type": "assignment",
            "next": "calculate_or_pull_from_database_zero_point_energy_of_element_2",
            "assignment": {
                "scope": "global",
                "name": "zero_point_energy_element1",
                "value": "zero_point_energy"
            }
        },
        {
            "type": "assignment",
            "flowchartId": "calculate_or_pull_from_database_zero_point_energy_of_element_2",
            "next": "reset_PARAMETER",
            "assignment": {
                "scope": "global",
                "name": "previous_SCALAR_RESULT",
                "value": "0"
            }
        },
        {
            "type": "assignment",
            "flowchartId": "initialize_PARAMETER_element2",
            "next": "initialize_previous_SCALAR_RESULT_element2",
            "assignment": {
                "name": "PARAMETER",
                "value": "1"
            }
        },
        {
            "type": "assignment",
            "flowchartId": "reset_previous_SCALAR_RESULT_element2",
            "next": "run_scf_calculation_of_element2",
            "assignment": {
                "name": "previous_SCALAR_RESULT_element2",
                "value": 0
            }
        },
        {
            "flowchartId": "run_scf_calculation_of_element2",
            "type": "execution",
            "next": "check_for_convergence_of_element2",
            "preProcessors": [
                {
                    "type": "command",
                    "name": "copy_file",
                    "kwargs": {
                        "source": "KPOINTS",
                        "destination": "KPOINTS.convergence.save.element2"
                    }
                }
            ],
            "monitors": [
                {
                    "name": "standard_output"
                },
                {
                    "name": "delta_energy"
                },
                {
                    "name": "total_energy"
                }
            ],
            "postProcessors": [],
            "execution": {
                "app": {
                    "name": "vasp",
                    "exec": "vasp"
                },
                "input": [
                    {
                        "name": "KPOINTS",
                        "content": "include_text(KPOINTS)"
                    },
                    {
                        "name": "INCAR",
                        "content": "include_text(INCAR)"
                    },
                    {
                        "name": "POSCAR",
                        "content": "include_text(POSCAR_O2)"
                    },
                    {
                        "name": "POTCAR",
                        "path": "POTCAR_O"
                    }
                ]
            },
            "results": [
                {
                    "name": "total_energy"
                },
                {
                    "name": "band_gap"
                },
                {
                    "name": "bandstructure"
                }
            ]
        },
        {
            "flowchartId": "check_for_convergence_of_element2",
            "type": "condition",
            "condition": {
                "input": [
                    {
                        "scope": "global",
                        "name": "previous_SCALAR_RESULT_element2"
                    },
                    {
                        "scope": "run_scf_calculation_of_element2",
                        "name": "total_energy"
                    }
                ],
                "statement": "abs(previous_SCALAR_RESULT_element2-total_energy) < 1e-3",
                "then": "convergence_is_reached_of_element2",
                "else": "assign_total_energy_to_previous_SCALAR_RESULT_of_element2",
                "maxOccurences": 100
            }
        },
        {
            "flowchartId": "assign_total_energy_to_previous_SCALAR_RESULT_of_element2",
            "type": "assignment",
            "next": "increase_PARAMETER_by_1_of_element2",
            "assignment": {
                "input": [
                    {
                        "scope": "run_scf_calculation_of_element2",
                        "name": "total_energy"
                    }
                ],
                "name": "previous_SCALAR_RESULT",
                "value": "total_energy"
            }
        },
        {
            "flowchartId": "increase_PARAMETER_by_1_of_element2",
            "type": "assignment",
            "next": "run_scf_calculation_of_element2",
            "assignment": {
                "input": [
                    {
                        "scope": "global",
                        "name": "PARAMETER"
                    }
                ],
                "name": "PARAMETER",
                "value": "PARAMETER+1"
            }
        },
        {
            "flowchartId": "convergence_is_reached_of_element2",
            "type": "assignment",
            "next": "run_relaxation_of_element2",
            "assignment": {
                "input": [
                    {
                        "scope": "global",
                        "name": "PARAMETER"
                    }
                ],
                "name": "PARAMETER",
                "value": "PARAMETER-1"
            }
        },
        {
            "status": "idle",
            "flowchartId": "run_relaxation_of_element2",
            "type": "execution",
            "next": "set_total_energy_of_element2",
            "monitors": [
                {
                    "name": "standard_output"
                },
                {
                    "name": "delta_energy"
                },
                {
                    "name": "total_energy"
                }
            ],
            "postProcessors": [
                {
                    "type": "command",
                    "name": "copy_file",
                    "kwargs": {
                        "source": "CONTCAR",
                        "destination": "POSCAR"
                    }
                }
            ],
            "execution": {
                "app": {
                    "name": "vasp",
                    "exec": "vasp"
                },
                "input": [
                    {
                        "name": "INCAR",
                        "content": "include_text(INCAR_rlx)"
                    }
                ]
            },
            "results": [
                {
                    "name": "total_energy"
                },
                {
                    "name": "band_gap"
                },
                {
                    "name": "bandstructure"
                }
            ]
        },
        {
            "flowchartId": "set_SCALAR_RESULT_of_element2",
            "type": "assignment",
            "next": "run_zero_point_energy_of_element2",
            "assignment": {
                "scope": "global",
                "name": "SCALAR_RESULT_element2",
                "value": "total_energy"
            }
        },
        {
            "flowchartId": "run_zero_point_energy_of_element2",
            "name": "run_zero_point_energy_of_element2",
            "type": "execution",
            "next": "done_with_convergence_plus_zero_point_energy_of_element2",
            "execution": {
                "app": {
                    "flavor": "vasp",
                    "exec": "vasp",
                    "name": "vasp"
                },
                "input": [
                    {
                        "name": "INCAR",
                        "content": "include_text(INCAR_zpe)"
                    }
                ]
            },
            "results": [
                {
                    "name": "total_energy"
                },
                {
                    "name": "zero_point_energy"
                }
            ],
            "monitors": [
                {
                    "name": "standard_output"
                },
                {
                    "name": "delta_energy"
                },
                {
                    "name": "total_energy"
                }
            ]
        },
        {
            "flowchartId": "set_zero_point_energy_of_element2",
            "type": "assignment",
            "next": "calculate_formation_energy",
            "assignment": {
                "scope": "global",
                "name": "zero_point_energy_element2",
                "value": "zero_point_energy"
            }
        },
        {
            "flowchartId": "calculate_formation_energy",
            "type": "exit",
            "name": "exit",
            "status": "idle",
            "app": {},
            "exit": {
                "throwException": false
            }
        }
    ]
}
