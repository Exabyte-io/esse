{
    "app": "espresso",
    "units": [
        {
            "type": "assignment",
            "flowchartId": "init_tolerance",
            "next": "init_increment",
            "head": true,
            "assignment": {
                "name": "TOLERANCE",
                "value": "0"
            }
        },
        {
            "type": "assignment",
            "flowchartId": "init_increment",
            "next": "init_scalar",
            "head": true,
            "assignment": {
                "name": "INCREMENT",
                "value": "1"
            }
        },
        {
            "type": "assignment",
            "flowchartId": "init_scalar_value",
            "next": "init_parameter",
            "assignment": {
                "name": "PREVIOUS_SCALAR_VALUE",
                "value": "0"
            }
        },
        {
            "type": "assignment",
            "flowchartId": "init_parameter",
            "next": "extract_characteristic",
            "assignment": {
                "name": "PARAMETER",
                "value": "1"
            }
        },
        {
            "replace": true,
            "flowchartId": "extract_characteristic",
            "next": "check_convergence",
            "results": [
                {
                    "name": "total_energy"
                }
            ]
        },
        {
            "replace": true,
            "type": "assignment",
            "flowchartId": "assign scalar globally",
            "next": "check_convergence",
            "assignment": {
                "input": [
                    {
                        "scope": "extract_characteristic",
                        "name": "total_energy"
                    }
                ],
                "name": "SCALAR_RESULT",
                "value": "total_energy"
            }
        },
        {
            "flowchartId": "check_convergence",
            "type": "condition",
            "condition": {
                "input": [
                    {
                        "scope": "global",
                        "name": "PREVIOUS_SCALAR_VALUE"
                    },
                    {
                        "scope": "extract_characteristic",
                        "name": "SCALAR_RESULT"
                    }
                ],
                "statement": "abs(PREVIOUS_SCALAR_VALUE - SCALAR_RESULT) < TOLERANCE",
                "then": "convergence_is_reached",
                "else": "save_previous_value",
                "maxOccurences": 100
            }
        },
        {
            "flowchartId": "save_previous_value",
            "type": "assignment",
            "next": "increase_parameter_by_1",
            "assignment": {
                "input": [
                    {
                        "scope": "extract_characteristic",
                        "name": "SCALAR_RESULT"
                    }
                ],
                "name": "PREVIOUS_SCALAR_VALUE",
                "value": "SCALAR_RESULT"
            }
        },
        {
            "flowchartId": "increase_parameter_by_1",
            "type": "assignment",
            "next": "extract_characteristic",
            "assignment": {
                "input": [
                    {
                        "scope": "global",
                        "name": "PARAMETER"
                    }
                ],
                "name": "PARAMETER",
                "value": "PARAMETER + INCREMENT"
            }
        },
        {
            "flowchartId": "convergence_is_reached",
            "type": "assignment",
            "next": "exit",
            "assignment": {
                "input": [
                    {
                        "scope": "global",
                        "name": "PARAMETER"
                    }
                ],
                "name": "PARAMETER",
                "value": "PARAMETER - INCREMENT"
            }
        },
        {
            "flowchartId": "exit",
            "type": "exit",
            "exit": {
                "throwException": false
            }
        }
    ]
}
